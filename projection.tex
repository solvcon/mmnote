% (C) 2022 Yung-Yu Chen.  All rights reserved.

\RequirePackage[2020-02-02]{latexrelease}
\documentclass[11pt,dvips]{article}
%\documentclass[12pt,dvips]{article}
%\documentclass[preprint,dvips,numbers,sort&compress]{elsarticle}
%\documentclass[12pt,review,dvips,numbers,sort&compress]{elsarticle}
% Geometry.
\usepackage{geometry}
\geometry{a4paper,
left=2cm,
right=2cm,
top=2cm,
bottom=2cm,
}
% Global functionalities.
\usepackage[numbers,sort&compress]{natbib}
\usepackage{hyperref}
% encoding.
\usepackage[utf8]{inputenc}
% Mathematics.
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{arydshln}
% Authoring.
%\usepackage{authblk}
\usepackage[printwatermark]{xwatermark}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{paralist}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{setspace}
%\usepackage{lmodern}

\newwatermark[allpages,color=black!30,angle=45,scale=3,xpos=0,ypos=0]%
{DRAFT}

%\doublespacing

\graphicspath{{turgon_eps/}}

\renewcommand{\figurename}{Fig.}
\newcommand{\topcaption}{%
\setlength{\abovecaptionskip}{0pt}%
\setlength{\belowcaptionskip}{10pt}%
\caption}
\numberwithin{equation}{section}

\newcommand{\defeq}{\ensuremath{\buildrel {\text{def}}\over{=}}}

\title{
%
(Drafting) Projection Method
%
}

\author{
%
Yi-En Chou and Yung-Yu Chen
%
}

\begin{document}

\maketitle

\begin{abstract}
%
%
\end{abstract}


\section{Govern equations for 2D incompressible flow}
%
\label{s:projection}

For simplicity, suppose $\rho=1$.
Momentum equation in x-direction:
\begin{align*}
\frac{\partial u}{\partial t}+u \frac{\partial u}{\partial x}+v \frac{\partial u}{\partial y}=-\frac{\partial p}{\partial x}+ \nu (\frac{\partial^2 u}{\partial x^2}+\frac{\partial^2 u}{\partial y^2})
\label{1}
\end{align*}
Momentum equation in y-direction:
\begin{align*}
\frac{\partial v}{\partial t}+u \frac{\partial v}{\partial x}+v \frac{\partial v}{\partial y}=-\frac{\partial p}{\partial y}+ \nu (\frac{\partial^2 v}{\partial x^2}+\frac{\partial^2 v}{\partial y^2})
\label{2}
\end{align*}
Continuity:  
\begin{align*}
\frac{\partial u}{\partial x}+\frac{\partial v}{\partial y}=0
\label{3}
\end{align*}

\subsection{ Vector form}
Momentum equation:
\begin{align*}
\mathbf{u}_t+\mathbf{u}(\nabla \cdot \mathbf{u})=-\nabla p+\nu \nabla^2 \mathbf{u} 
\label{4}
\end{align*}
Continuity:
\begin{align*}
\nabla \cdot \mathbf{u}=0
\label{5}
\end{align*}

\section{Projection algorithm}
Velocity at $n^{th}$ time-step is denoted as $\mathbf{u}^n$. Convection term is denoted as $\mathbf{C}$, and diffusion term is denoted $\mathbf{D}$.
\begin{align*}
\frac{\mathbf{u}^{n+1}-\mathbf{u}^{n}}{\Delta t}+\mathbf{C}(\mathbf{u}^{n})=-\nabla p+\mathbf{D}(\mathbf{u}^{{n}}) 
\label{6}
\end{align*}
Solve for $\mathbf{u}^{n+1}$, we need to decide $\mathbf{P}$ beforehand. Projection algorithm is implemented with intermediate term $\mathbf{u}^{*}$, the momentum equation is split into 2 parts: 
\begin{align*}
\frac{\mathbf{u}^{*}-\mathbf{u}^{n}}{\Delta t}+\mathbf{C}(\mathbf{u}^{n})=\mathbf{D}(\mathbf{u}^{{n}}) 
\label{6a} 
\end{align*}
\begin{align*}
\frac{\mathbf{u}^{n+1}-\mathbf{u}^{*}}{\Delta t}=-\nabla p
\label{6b}
\end{align*}
take divergence, the equation becomes
\begin{align*}
\frac{\nabla \cdot(\mathbf{u}^{n+1}-\mathbf{u}^{*})}{\Delta t}=-\nabla ^2 p
\label{7}
\end{align*}
A distinguishing feature of the projection method is that the velocity field is forced to satisfy the continuity as a part of the algorithm, where
\begin{align*}
\nabla \cdot(\mathbf{u}^{n+1})=0
\label{8}
\end{align*}
and therefore  the equation becomes, 
\begin{align*}
\frac{\nabla \cdot(\mathbf{u}^{*})}{\Delta t}=\nabla ^2 p
\label{9}
\end{align*}

\subsection{The three steps of projection algorithm}
Step 1- Solve $\mathbf{u}^{*}$
\begin{align*}
\frac{\mathbf{u}^{*}-\mathbf{u}^{n}}{\Delta t}+\mathbf{C}(\mathbf{u}^{n})=\mathbf{D}(\mathbf{u}^{{n}}) 
\label{6a}
\end{align*}
Step 2- Solve $p$
\begin{align*}
\frac{\nabla \cdot(\mathbf{u}^{*})}{\Delta t}=\nabla ^2 p
\label{9}
\end{align*}
Step 3- Solve $\mathbf{u}^{n+1}$
\begin{align*}
\frac{\mathbf{u}^{n+1}-\mathbf{u}^{*}}{\Delta t}=-\nabla p
\label{6b}
\end{align*}


\section{Discretization}
\subsection{Taylor expansion} 
\begin{align*}
f(x+h)=f(x)+f'(x)\frac{h}{1!}+f''(x)\frac{h^2}{2!}+f'''(x)\frac{h^3}{3!}+... \label{10} \\
f(x-h)=f(x)-f'(x)\frac{h}{1!}+f''(x)\frac{h^2}{2!}-f'''(x)\frac{h^3}{3!}+... \label{11} 
\end{align*}
First derivatives via (10)-(11)
\begin{align*}
f(x+h)-f(x-h)=2\times f'(x)\frac{h}{1!}+2 \times f'''(x)\frac{h^3}{3!}+... \\
f(x+h)-f(x-h)=2\times f'(x)\frac{h}{1!}+O(h^3) \\
f'(x)=\frac{f(x+h)-f(x-h)}{2h} 
\label{12}
\end{align*}
Second derivative via (10)+(11)

\begin{align*}
f(x+h)+f(x-h)=2\times f(x)+2 \times f''(x)\frac{h^2}{2!}+4 \times f''''(x)\frac{h^4}{4!} \\
f(x+h)+f(x-h)=2\times f(x)+2 \times f''(x)\frac{h^2}{2!}+O(h^4) \\
f''(x)=\frac{f(x+h)+f(x-h)-2\times f(x)}{h^2}
\label{13}
\end{align*}
\subsection{The discretized three steps of projection algorithm}
Step 1- Solve $\mathbf{u}^{*}$
\begin{align*}
\frac{\mathbf{u}^{*}-\mathbf{u}^{n}}{\Delta t}+\mathbf{C}(\mathbf{u}^{n})=\mathbf{D}(\mathbf{u}^{{n}}) 
\label{6a}
\end{align*}
where
\begin{align*}
\mathbf{C}(u^n_{i,j})=u^n_{i,j} \cdot \frac{u^n_{e}-u^n_{w}}{\Delta x}+v^n_{p} \cdot \frac{u^n_{n}-u^n_{s}}{\Delta y} \\
\mathbf{D}(u^n_{i,j})=\nu (\frac{u^n_{e}+ u^n_{w}-2u^n_{i,j}}{(\Delta x/2)^2}+\frac{u^n_{n}+ u^n_{s}-2u^n_{i,j}}{(\Delta y/2)^2})
\end{align*}
Step 2- Solve $p$
\begin{align*}
\frac{\nabla \cdot(\mathbf{u}^{*})}{\Delta t}=\nabla ^2 p
\label{9}
\end{align*}
where
\begin{align*}
\nabla \cdot(\mathbf{u}^{*})=\frac{u^{*}_{e}-u^{*}_{w}}{\Delta x}+\frac{v^{*}_{n}-v^{*}_{s}}{\Delta y} \\
\nabla ^2 p=\frac{p_{i+1,j}+p_{i-1,j}-2p_{i,j}}{\Delta x^2}+\frac{p_{i,j+1}+p_{i,j-1}-2p_{i,j}}{\Delta y^2}
\end{align*}
Step 3- Solve $\mathbf{u}^{n+1}$
\begin{align*}
\frac{\mathbf{u}^{n+1}_{i,j}-\mathbf{u}^{*}_{i,j}}{\Delta t}=-\nabla p
\label{6b}
\end{align*}
where
\begin{align*}
\nabla p=\frac{p_{i+1,j}-p_{i,j}}{\Delta x}
\end{align*}

\clearpage

\addcontentsline{toc}{chapter}{Bibliography}
%\bibliographystyle{myunsrtnat} % no sort (order in appearance)
\bibliographystyle{myplainnat} % sort by author
\bibliography{turgon_main}

\end{document}

% vim: set ff=unix fenc=utf8 et sw=2 ts=2 tw=79:
